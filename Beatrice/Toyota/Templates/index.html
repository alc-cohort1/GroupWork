<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Customer form</title>
    <!-- <link rel="stylesheet" href="./style.css"> -->
    <!-- <script src="../validation.js"></script> -->
    <!-- links to Bootstrap -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <style>
            /*    */
        .container {
            padding-top: 8px;
            background-color: #fff0e6;
            margin-top: 13px;
            padding-bottom: 10px;
        
        }
        .content {
            padding-top: 8px;
            background-color: #fff0e6;
            margin-top: 13px;
            margin-left: 50px;
            margin-right: 50px;
            padding-left:50px;
            padding-right:50px;
            padding-bottom: 10px;
        
        }
        /* style for the section divs */
        #field{
            border: 1px solid #e0e0e0;
            padding: 2px; 
            background-color: #fdaf7b;
            
        }
        #field2{
            border: 1px solid #e0e0e0;
            padding: 2px; 
            background-color: #fdaf7b;
            width: 400px;
            
        }
        #fie{
            border: 1px solid #e0e0e0;
            padding: 10px; 
            height: 270px;
        }
        /* style for the legend */
        #leg{
            border-style: none;
            font-size: 12px;
            margin-bottom: 0;
            width: auto;
            padding: 0 10px;
        }
        button {
            background-color: #fdaf7b;
        }
        #btn {
            background-color: #fdaf7b;
        }
        #exit {
            width: 80px;
        }
        #output {
            background-color: #faf0e8;
            width: 150px;
            height: 30px;
        }
    </style>
</head>
<body>
    <div class="content">
           <!-- sales form -->
            <form action="order" method="POST" name="form" onsubmit="return orders()">
                <div class="row">
                    <div class="col-sm-8">
                        <div id="field">
                            <fieldset id="fie">
                                <!-- Section that captures Customer's information  -->
                                    <legend id="leg"><h3>Customer Information</h3></legend>
                                    <div class="row">
                                            <div class="col-sm-2">
                                                Customer ID: 
                                            </div>
                                            <div class="col-sm-10">
                                                <input type="text" name="customer_id"><span id="customer_id"></span>
                                            </div>
                                        </div><br>
                                        <div class="row">
                                            <div class="col-sm-2">
                                                Name: 
                                            </div>
                                            <div class="col-sm-10">
                                               <input type="text" name="customer_name"><span id="name"></span>
                                            </div>
                                        </div> <br> 
                                        <div class="row">
                                                <div class="col-sm-2">
                                                    Town: 
                                                </div>
                                                <div class="col-sm-4">
                                                   <input type="text" name="state"><span id="twn"></span>
                                                </div>
                                                <div class="col-sm-6">
                                                    <input type="checkbox" name="retailcustomer" checked> &nbsp; Retail Customer
                                                </div>
                                        </div><br>
                            </fieldset>
                                                      
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div id="field2">
                        <!-- Section that captures shipping information  -->
                        <fieldset id="fie">
                            <legend id="leg"><h3>Shipping</h3></legend>
                            <div class="row">
                                <div class="col-sm-6">
                                    <input type="radio" name="shipping"> &nbsp;UPS
                                </div>
                                <div class="col-sm-6">
                                    <input type="radio" name="shipping"> &nbsp;Fed Ex Ground
                                </div>
                            </div><br>
                            <div class="row">
                                    <div class="col-sm-6">
                                        <input type="radio" name="shipping"> &nbsp;US Postal Air
                                    </div>
                                    <div class="col-sm-6">
                                        <input type="radio" name="shipping"> &nbsp;Fed Ex Air
                                    </div>
                                </div>                        
                        </fieldset>
                    </div>
                </div>
                </div><br>
                <div class="row">
                        <div class="col-sm-8">
                            <div id="field">
                                <!-- Section that captures ordered parts information  -->
                            <fieldset id="fie">
                                <legend id="leg"><h3>Part Ordered</h3></legend>
                                <div class="row">
                                    <div class="col-sm-2">
                                        Part Number: 
                                    </div>
                                    <div class="col-sm-5">
                                        <input type="text" name="partno"><span id="part_no"></span>
                                    </div>
                                </div><br>
                                <div class="row">
                                    <div class="col-sm-2">
                                        Description: 
                                    </div>
                                    <div class="col-sm-5">
                                       <input type="text" name="description"><span id="descripn"></span>
                                    </div>
                                </div> <br>
                                <div class="row">
                                    <div class="col-sm-2">
                                        Price per part:
                                    </div>
                                    <div class="col-sm-5">
                                        <input type="text" name="price"><span id="ppp"></span>
                                    </div>
                                    <div class="col-sm-1">
                                        Quantity
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" name="quantity"><span id="qty"></span>
                                    </div>
                                </div><br> 
                                <div class="row " >
                                    <div class="col-sm-2"></div>
                                   <div class="col-sm-6">
                                        <input type="checkbox" name="oversizecontainer"> &nbsp; Oversize Container?
                                   </div> 
                                </div>                                                 
                            </fieldset>
                        </div>
                        </div>
                        <div class="col-sm-4"  id="main">
                            <div id="field2">
                            <fieldset id="fie">
                                <!-- Section that outputs costs  information  -->
                                <legend id="leg"><h3>Output</h3></legend>
                                <div class="row">
                                        <div class="col-sm-6">
                                            Cost:
                                        </div>
                                        <div class="col-sm-6" id="output">
                                            <span id="cost"></span>
                                        </div> 
                                </div>  <br>
                                <div class="row">
                                        <div class="col-sm-6">
                                            Sales Tax:
                                        </div>
                                        <div class="col-sm-6" id="output">
                                            <span id="salestax"></span>
                                        </div> 
                                </div> <br>   
                                <div class="row">
                                        <div class="col-sm-6">
                                            Shipping & handling:
                                        </div>
                                        <div class="col-sm-6" id="output">
                                            <span id="shipping"></span>
                                        </div> 
                                </div>   
                                <div class="row"><br>   
                                        <div class="col-sm-6">
                                            Total:
                                        </div>
                                        <div class="col-sm-6" id="output">
                                            <span id="total"></span>
                                        </div> 
                                </div><br>                                                                                                                                                      
                            </fieldset>
                        </div>
                        </div>
                    </div><br>
                    <div class="row">
                        <div class="col-sm-3">
                            <input type="submit" value="Compute" id="btn">
                        </div>
                        <div class="col-sm-2">
                                <button type="reset">New Order</button>
                            </div> 
                            <div class="col-sm-4"></div>
                            <div class="col-sm-3">
                                    <button type="" id="exit">Exit</button>
                                </div>                       
                    </div>     
         
            </form>
        
    </div>
    <script>
    function orders() {
        //Variables that keep values from the form inputs
        var customerId = document.form.customer_id.value;
        var name = document.form.customer_name.value;
        var town = document.form.state.value;
        var partno = document.form.partno.value;
        var description = document.form.description.value;
        var price_per_part = document.form.price.value;
        var quantity = document.form.quantity.value;
        var shipping = document.form.shipping.value;
        var oversize = document.form.oversizecontainer.value;
        var cost = (price_per_part * quantity).toFixed(2);//to two decimal places

            /*
            This function validates the customer form to check if the user input is correct
            */
            function validData(){
                var noSpace = /\s/;
                var num = /[^0-9]/;
                if (!customerId || customerId.match(noSpace))
                {
                    document.getElementById("customer_id").innerHTML="<b>Required and cannot contain blank spaces</b>";
                    return false;
                } 
                else if (!name){
                    document.getElementById("name").innerHTML="<b>Required</b>";
                    return false;
                }
                else if (town.length != 3){
                    document.getElementById("twn").innerHTML="<b>Town must be of three characters</b>";
                    return false;
                }
                else if (!partno){
                    document.getElementById("part_no").innerHTML="<b>Required</b>";
                    return false;
                }
                else if(!description){
                    document.getElementById("descripn").innerHTML="<b>Required</b>";
                    return false;
                }
                else if(isNaN(price_per_part) || price_per_part <= 0){
                    document.getElementById("ppp").innerHTML="<b>Price must be a number that is greater than zero</b>";
                    return false;
                } 
                else if(num.test(quantity) || quantity <= 0){
                    document.getElementById("qty").innerHTML="<b>Price must be a number that is greater than zero</b>";
                    return false;                    
                } else {
                    return salesTax(cost);
                }
    
            }
            /*
            This function compues the sales tax*/
            function salesTax(amount){
                //displaying cost
                document.getElementById("cost").innerHTML = `$ ${cost}`;
                    
                this.cost = amount;
                // Calculating the sales tax for Kampala, Mbarara, Entebbe and other towns
                if (town === "KLA") {
                    tax = this.cost * 0.1;
                    } else if (town === "EBB" || town === "MBR") {
                    tax = this.cost * 0.05;
                    } else {
                    tax = 0.0;
                    }
                //Displaying the sales tax
                document.getElementById("salestax").innerHTML = `$ ${tax.toFixed(2)}`;

                // getter for the total tax
                this.getTax = function() {
                return tax;
                };
                return shippingHandling();
            }
            /*
            This function computes the cost of shipping and handling
            */
           function shippingHandling(){
                // Calculating the shipping cost
                if (shipping === "UPS") {
                shippingCost = 7.0;
                } else if (shipping === "Fed Ex Ground") {
                shippingCost = 8.5;
                } else if (shipping === "US Portal Air") {
                shippingCost = 9.25;
                } else {
                shippingCost = 12.0;
                }
                //oversize container
                if (oversize.checked) {
                handlingCost = 5.0;
                } else {
                handlingCost = 0.0;
                }
                //Calculating total shipping & handling cost
                totalShippingCost = (quantity * (shippingCost + handlingCost)).toFixed(2);
                //displaying total shipping cost
                document.getElementById("shipping").innerHTML = `$ ${totalShippingCost}`;

                this.getshippingCost = function() {
                return totalShippingCost;
                };
                return totalCost();

           }
           // Function to calculate the total cost
           function totalCost(){
               var total = parseFloat(cost) + parseFloat(window.tax + parseFloat(window.totalShippingCost)).toFixed(2);
               //displaying total
               document.getElementById("total").innerHTML = `$ ${total}`;
           }   
        validData();
        // return false;
        
    }  
        
   
    </script>
</body>
</html>