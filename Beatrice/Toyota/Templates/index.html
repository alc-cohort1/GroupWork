<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Customer form</title>
    <!-- links to Bootstrap -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!--Styling the page -->
    <style>
        /* Styling the body */
        body {
            background-image: url("../img/tyot.jpg");
        }
        /* Styling navigation bar */
        .navbar-brand {
            color: white;
            font-size: 30px;
        }

        #out a {
            color: white;
            font-size: 18px;
        }
        #out :hover {
            color: gray;
            
        }
        /*  
        Style for the container  */
        .container {
            padding-top: 8px;
            background-color: #efeffd;
            margin-top: 13px;
            padding-bottom: 10px;
        
        }
        .content {
            padding-top: 8px;
            background-color: rgb(153, 151, 151);
            margin-top: 13px;
            margin-left: 50px;
            margin-right: 50px;
            padding-left:50px;
            padding-right:50px;
            padding-bottom: 10px;
            max-height: 563px;
            max-width: 1500px;
            opacity: 0.9;
        
        }
        /* 
        Style for the section divs */
        #field{
            border: 1px solid #e6e6ff;
            padding: 2px; 
            background-color: rgb(201, 199, 199);
            
        }
        #field2{
            border: 1px solid #cccccf;
            padding: 2px; 
            background-color: rgb(201, 199, 199);
            width: 400px;
            
        }
        #fie{
            border: 1px solid #e6e6ff;
            padding: 10px; 
            height: 235px;
            
        }
        /* 
        Style for the legend in the fieldset */
        #leg{
            border-style: none;
            font-size: 12px;
            margin-bottom: 0;
            width: auto;
            padding: 0 10px;
        }
        /* 
        Styling the buttons */
        button {
            background-color: #D8D8D8;
        }
        #btn {
            background-color: #D8D8D8;
        }
        #exit {
            width: 80px;
            text-decoration: none;
            color: rgb(24, 24, 24);
        }
        /* Styling the output section */
        #output {
            background-color: white;
            width: 150px;
            height: 25px;
        }
        /* 
        Styling the footer */
        #copyright {
            color: rgb(8, 8, 8);
        }
    </style>
</head>
<body >
    <!-- Creating a navigation bar -->
        <nav class="navbar">
                <div class="container-fluid">
                  <div class="navbar-header">
                    <strong class="navbar-brand">Toyota Order Form</strong>
                  </div>
                  <ul class="nav navbar-nav navbar-right" id="out">
                    <li><a href="./logout"><span class="glyphicon glyphicon-log-out"></span> Logout</a></li>
                  </ul>
                  
                </div>
        </nav>
    <div class="content">
           <!--Creating a sales form that caputers data about an order and makes calculations-->
            <form action="order" method="POST" name="form" onsubmit="return orders()" id="myform">
                <div class="row">
                    <div class="col-sm-8">
                        <div id="field">
                            <fieldset id="fie">
                                <!-- Section that captures Customer's information  -->
                                    <legend id="leg"><h3> <b>Customer Information</b> </h3></legend>
                                    <div class="row">
                                            <div class="col-sm-2">
                                                Customer ID: 
                                            </div>
                                            <div class="col-sm-10">
                                                <input type="text" name="customer_id" placeholder="123-45-67"><span id="customer_id"></span>
                                            </div>
                                        </div><br>
                                        <div class="row">
                                            <div class="col-sm-2">
                                                Name: 
                                            </div>
                                            <div class="col-sm-10">
                                               <input type="text" name="customer_name" placeholder="Enter name here"><span id="name"></span>
                                            </div>
                                        </div> <br> 
                                        <div class="row">
                                                <div class="col-sm-2">
                                                    Town: 
                                                </div>
                                                <div class="col-sm-4">
                                                   <input type="text" name="state" placeholder="EBB / KLA / MBR" oninput="this.value=this.value.toUpperCase()"><span id="twn"></span>
                                                </div>
                                                <div class="col-sm-6">
                                                    <input type="checkbox" name="retailcustomer" checked> &nbsp; Retail Customer
                                                </div>
                                        </div><br>
                            </fieldset>
                                                      
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div id="field2">
                        <!-- Section that captures shipping information  -->
                        <fieldset id="fie">
                            <legend id="leg"><h3><b>Shipping</b></h3></legend>
                            <div class="row">
                                <div class="col-sm-6">
                                    <input type="radio" name="shipping" checked> &nbsp;UPS
                                </div>
                                <div class="col-sm-6">
                                    <input type="radio" name="shipping"> &nbsp;Fed Ex Ground
                                </div>
                            </div><br>
                            <div class="row">
                                    <div class="col-sm-6">
                                        <input type="radio" name="shipping"> &nbsp;US Postal Air
                                    </div>
                                    <div class="col-sm-6">
                                        <input type="radio" name="shipping"> &nbsp;Fed Ex Air
                                    </div>
                                </div>                        
                        </fieldset>
                    </div>
                </div>
                </div><br>
                <div class="row">
                        <div class="col-sm-8">
                            <div id="field">
                                <!-- Section that captures ordered parts information  -->
                            <fieldset id="fie">
                                <legend id="leg"><h3><b>Part Ordered</b> </h3></legend>
                                <div class="row">
                                    <div class="col-sm-2">
                                        Part Number: 
                                    </div>
                                    <div class="col-sm-5">
                                        <input type="text" name="partno" placeholder="001"><span id="part_no"></span>
                                    </div>
                                </div><br>
                                <div class="row">
                                    <div class="col-sm-2">
                                        Description: 
                                    </div>
                                    <div class="col-sm-5">
                                       <input type="text" name="description" placeholder="Oil Filter"><span id="descripn"></span>
                                    </div>
                                </div> <br>
                                <div class="row">
                                    <div class="col-sm-2">
                                        Price per part:
                                    </div>
                                    <div class="col-sm-5">
                                        <input type="text" name="price" placeholder="$7.51"><span id="ppp"></span>
                                    </div>
                                    <div class="col-sm-1">
                                        Quantity
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" name="quantity" placeholder="2"><span id="qty"></span>
                                    </div>
                                </div><br> 
                                <div class="row " >
                                    <div class="col-sm-2"></div>
                                   <div class="col-sm-6">
                                        <input type="checkbox" name="oversizecontainer"> &nbsp; Oversize Container?
                                   </div> 
                                </div>                                                 
                            </fieldset>
                        </div>
                        </div>
                        <div class="col-sm-4"  id="main">
                            <div id="field2">
                            <fieldset id="fie">
                                <!-- Section that outputs costs  information  -->
                                <legend id="leg"><h3><b>Output</b></h3></legend>
                                <div class="row">
                                        <div class="col-sm-6">
                                            Cost:
                                        </div>
                                        <div class="col-sm-6" id="output">
                                            <span id="cost"></span>
                                        </div> 
                                </div>  <br>
                                <div class="row">
                                        <div class="col-sm-6">
                                            Sales Tax:
                                        </div>
                                        <div class="col-sm-6" id="output">
                                            <span id="salestax"></span>
                                        </div> 
                                </div> <br>   
                                <div class="row">
                                        <div class="col-sm-6">
                                            Shipping & handling:
                                        </div>
                                        <div class="col-sm-6" id="output">
                                            <span id="shipping"></span>
                                        </div> 
                                </div>   
                                <div class="row"><br>   
                                        <div class="col-sm-6">
                                            Total:
                                        </div>
                                        <div class="col-sm-6" id="output">
                                            <span id="total"></span>
                                        </div> 
                                </div><br>                                                                                                                                                      
                            </fieldset>
                        </div>
                        </div>
                    </div><br>
                    <div class="row">
                        <div class="col-sm-3">
                           <b><input type="submit" value="Compute" id="btn"></b> 
                        </div>
                        <div class="col-sm-2">
                            <!-- Creating a reset button that refreshes the page -->
                            <button type="reset"  onclick="{ window.location.reload(); }" ><b>New Order</b></button>
                        </div> 
                            <div class="col-sm-4"> <p id="copyright"><b><i>© 2019 &nbsp; Beatrice Nakabanda &nbsp;&nbsp;&nbsp;&nbsp; </i> </b></p></div>
                            <div class="col-sm-3">
                                <!-- Creating a logout button that exits the page -->
                                <a href="./logout"> <button type="button" id="exit" ><b>Exit</b></button></a>                  
                            </div>                      
                    </div>      
            </form>          
    </div>
    <script>
        <!--
            /*
            Creating a function that calculates cost, holds other functions and is called on submiting a form
            */
            function orders() {
                /*
                Variables that keep values from the form inputs*/
                var customerId = document.form.customer_id.value;
                var name = document.form.customer_name.value;
                var town = document.form.state.value;
                var partno = document.form.partno.value;
                var description = document.form.description.value;
                var price_per_part = document.form.price.value;
                var quantity = document.form.quantity.value;
                var shipping = document.form.shipping.value;
                var oversize = document.form.oversizecontainer.value;
                // variable that calculates cost and fixes it to two decimal places
                var cost = (price_per_part * quantity).toFixed(2);


            /*
            This function validates the customer form to check if the user input is correct
            */
            function validData(){
                var space = /\s/;
                if (!customerId || customerId.match(space))
                {
                    document.getElementById("customer_id").innerHTML="<b>Required and cannot contain blank spaces</b>";
                    return false;
                } 
                else if (!name){
                    document.getElementById("name").innerHTML="<b>Required</b>";
                    return false;
                }
                else if (town.length != 3){
                    document.getElementById("twn").innerHTML="<b>Town must be of three characters</b>";
                    return false;
                }
                else if (!partno){
                    document.getElementById("part_no").innerHTML="<b>Required</b>";
                    return false;
                }
                else if(!description){
                    document.getElementById("descripn").innerHTML="<b>Required</b>";
                    return false;
                }
                else if(isNaN(price_per_part) || price_per_part <= 0){
                    document.getElementById("ppp").innerHTML="<b>Price must be a number that is greater than zero</b>";
                    return false;
                } 
                else if(isNaN(quantity) || quantity <= 0){
                    document.getElementById("qty").innerHTML="<b>Price must be a number that is greater than zero</b>";
                    return false;                    
                } else {
                    return salesTax(cost);
                }
    
            }
            /*
            This function computes the sales tax
            */
            function salesTax(amount){
                //Displaying cost
                document.getElementById("cost").innerHTML = `$ ${cost}`;
                    
                this.cost = amount;
                // Calculating the sales tax for Kampala, Mbarara, Entebbe and other towns
                if (town === "KLA") {
                    tax = this.cost * 0.1;
                    } else if (town === "EBB" || town === "MBR") {
                    tax = this.cost * 0.05;
                    } else {
                    tax = 0.0;
                    }
                //Displaying the sales tax
                document.getElementById("salestax").innerHTML = `$ ${tax.toFixed(2)}`;

                // geting the total tax
                this.getTax = function() {
                return tax;
                };
                return shippingHandling();
            }
            /*
            This function computes the cost of shipping and handling
            */
           function shippingHandling(){
                /* 
                Calculating the shipping cost
                */
                if (shipping === "UPS") {
                shippingCost = 7.0;
                } else if (shipping === "Fed Ex Ground") {
                shippingCost = 8.5;
                } else if (shipping === "US Portal Air") {
                shippingCost = 9.25;
                } else {
                shippingCost = 12.0;
                }
                /*
                Checking if oversize container is checked or not
                */
                if (oversize.checked) {
                handlingCost = 5.0;
                } else {
                handlingCost = 0.0;
                }
                //Calculating total shipping & handling cost and fixing it to two decimal places
                totalShippingCost = (quantity * (shippingCost + handlingCost)).toFixed(2);
                //Displaying total shipping and handling cost
                document.getElementById("shipping").innerHTML = `$ ${totalShippingCost}`;
                //Getting the shiping cost and returning it
                this.getshippingCost = function() {
                return totalShippingCost;
                };
                return totalCost();

           }
           /*
           Function to calculate the total cost*/
           function totalCost(){
               var total = parseFloat(cost) + parseFloat(window.tax + parseFloat(window.totalShippingCost)).toFixed(2);
               //Displaying total
               document.getElementById("total").innerHTML = `$ ${total}`;
           }  
        //Calling validData function    
        validData();
    }  
    -->
    </script>
</body>
</html>